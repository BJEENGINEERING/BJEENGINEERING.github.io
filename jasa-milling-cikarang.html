<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Jasa Milling Cikarang - BJE Engineering</title>
  <meta name="description" content="Jasa milling Cikarang untuk pembuatan keyway, gear custom, dan part industri presisi.">
  <meta name="keywords" content="jasa milling Cikarang, milling presisi, milling keyway, milling gear">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ✅ Dropdown Akun Modern + Tombol Aksi + Search -->
<div class="account-dropdown-row">
  <div class="search-container">
    <form id="live-search-form" class="search-inline">
      <input type="text" id="search-input" placeholder="Cari layanan atau galeri..." class="search-box">
      <select id="category-filter" class="search-select">
        <option value="all">Semua</option>
        <option value="bubut">Bubut</option>
        <option value="milling">Milling</option>
        <option value="slotting">Slotting</option>
        <option value="fabrikasi">Fabrikasi</option>
      </select>
      <button type="submit" class="search-btn" title="Cari">🔍</button>
    </form>
    <div id="search-results" class="grid-results"></div>
  </div>

  <div class="icon-buttons" id="actionButtons" style="display: none;">
    <button class="icon-button" title="Pesan"><span>📩</span></button>
    <button class="icon-button" title="Notifikasi"><span>🔔</span></button>
    <button class="icon-button" title="Order Saya"><span>📝</span></button>
  </div>

  <div class="avatar-container" id="userMenu" style="display: none;" onclick="toggleDropdown()">
    <img src="images/user-icon.png" alt="User Avatar" class="avatar">
  </div>

  <div id="authButtons" class="auth-buttons" style="display: none;">
    <a href="login.html" class="login-btn">Login</a>
    <a href="register.html" class="register-btn">Daftar</a>
  </div>
</div>

<!-- Tetap sisakan dropdownContent terpisah -->
<div class="dropdown-panel" id="dropdownContent">
  <div class="user-info">
    <img src="images/user-icon.png" class="avatar small" alt="User Avatar">
    <div>
      <strong>BJE User</strong><br>
      <span>user@example.com</span>
    </div>
  </div>
  <a href="#"><i>📂</i> Dashboard</a>
  <a href="#"><i>⚙️</i> Pengaturan</a>
  <a href="#"><i>📦</i> Pesanan</a>
  <a href="#" onclick="logout()"><i>🚪</i> Logout</a>
</div>
  
<header>
  <h1>Jasa Milling Cikarang</h1>
  <p>Solusi Milling Presisi dan Efisien untuk Industri Anda</p>
</header>

<div class="container">
  <nav class="breadcrumb" aria-label="Breadcrumb">
    <a href="index.html">Beranda</a> &rsaquo; <span>Jasa Milling</span>
  </nav>

  <section>
    <p>Kami mengerjakan berbagai kebutuhan <strong>milling manual & semi-CNC</strong> seperti pembuatan keyway, slot, tap, housing, dan gear custom.</p>
    <div class="features">
      <div class="feature-box">✅ Milling Keyway dan Spline</div>
      <div class="feature-box">✅ Pembuatan Gear Presisi</div>
      <div class="feature-box">✅ Material: Baja, Aluminium, Plastik Teknik</div>
    </div>
    <a href="index.html#hubungi-kami" class="button">💬 Ajukan Permintaan Sekarang</a>
  </section>

  <section>
    <h2>Galeri Hasil Milling</h2>
    <div class="gallery">
      <div class="card"><img src="images/IMG_20200114_152602.jpg" alt="Drilling"><p>Milling Lubang</p></div>
      <div class="card"><img src="images/IMG_20180711_112550.jpg" alt="Milling Keyway"><p>Milling Keyway</p></div>
    </div>
  </section>

  <section>
    <h2>Kontak Kami</h2>
    <p>📞 Hubungi <a href="https://wa.me/628982425835">0898-2425-835</a> untuk konsultasi & order.</p>
    <a href="https://bjeengineering.infinityfreeapp.com/#form" class="button">📥 Formulir Penawaran</a>
  </section>
</div>

<!-- ✅ Footer -->
<footer>
  <p>&copy; 2025 BJE ENGINEERING | Jasa Milling Cikarang</p>
  <p>
    <strong>Layanan:</strong>
    <a href="jasa-bubut-cikarang.html">Bubut</a> |
    <a href="jasa-milling-cikarang.html">Milling</a> |
    <a href="jasa-slotting-cikarang.html">Slotting</a> |
    <a href="fabrikasi-komponen-industri.html">Fabrikasi</a> |
    <a href="portofolio.html">Portofolio</a>
  </p>
</footer>

<!-- ✅ Script Dropdown -->
  <script>
    function toggleDropdown() {
      const panel = document.getElementById("dropdownContent");
      panel.style.display = panel.style.display === "block" ? "none" : "block";
    }

    window.addEventListener("click", function (e) {
      if (!e.target.closest(".account-dropdown")) {
        document.getElementById("dropdownContent").style.display = "none";
      }
    });

    window.addEventListener("DOMContentLoaded", () => {
      const loggedIn = localStorage.getItem('login') === 'true';
      if (loggedIn) {
        document.getElementById("userMenu").style.display = 'block';
      } else {
        document.getElementById("authButtons").style.display = 'flex';
      }
    });

    function logout() {
      localStorage.removeItem('login');
      window.location.reload();
    }
  </script>

<!-- Fuse.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>

<script>
  async function fetchIndex() {
    const res = await fetch('search-index.json');
    return await res.json();
  }

  function renderResults(results) {
    const container = document.getElementById('search-results');
    container.innerHTML = '';
    if (results.length === 0) {
      container.innerHTML = '<p>Tidak ada hasil ditemukan.</p>';
      return;
    }
    results.forEach(item => {
      const card = document.createElement('a');
      card.className = 'result-card';
      card.href = item.url;
      card.innerHTML = `
        ${item.image ? `<img src="${item.image}" alt="${item.title}">` : ''}
        <div class="result-content">
          <div class="result-title">${item.title}</div>
          <div class="result-category">Kategori: ${item.category}</div>
          <div class="result-description">${item.description}</div>
        </div>
      `;
      container.appendChild(card);
    });
  }

  async function initLiveSearch() {
    const data = await fetchIndex();
    const fuse = new Fuse(data, {
      keys: ['title', 'description', 'category'],
      includeScore: false,
      threshold: 0.4,
    });

    const input = document.getElementById('search-input');
    const category = document.getElementById('category-filter');
    const form = document.getElementById('live-search-form');

    function searchNow(e) {
      if (e) e.preventDefault();
      const keyword = input.value.trim();
      const selected = category.value;
      let results = keyword ? fuse.search(keyword).map(r => r.item) : data;
      if (selected !== 'all') {
        results = results.filter(r => r.category === selected);
      }
      renderResults(results);
    }

    input.addEventListener('input', searchNow);
    category.addEventListener('change', searchNow);
    form.addEventListener('submit', searchNow);
  }

  initLiveSearch();
</script>

</body>
</html>
